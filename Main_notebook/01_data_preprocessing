# ğŸ“Œ Importar librerÃ­as necesarias
import pandas as pd
import os
import glob
import numpy as np
import scipy.signal as sc
import matplotlib.pyplot as plt
from IPython.display import display, clear_output

# ğŸ“‚ Definir rutas a los datos (Google Drive)
training_path = "/content/drive/My Drive/PSF/Training"
test_path = "/content/drive/My Drive/PSF/Test"
csv_path = "/content/drive/My Drive/PSF/training_v2.csv"

print(f"ğŸ“ Ruta de entrenamiento: {training_path}")
print(f"ğŸ“ Ruta de test: {test_path}")
print(f"ğŸ“„ Archivo CSV: {csv_path}")

# âœ… Verificar si las rutas existen
if not os.path.exists(training_path) or not os.path.exists(test_path) or not os.path.exists(csv_path):
    print("âŒ Error: Una o mÃ¡s rutas de datos no existen. Revisa la conexiÃ³n con Google Drive.")
else:
    print("âœ… Todas las rutas de datos existen.")

# ğŸ“œ Cargar archivo CSV
try:
    training_csv = pd.read_csv(csv_path)
    print("âœ… Archivo CSV cargado correctamente.")
except Exception as e:
    print(f"âŒ Error al cargar el archivo CSV: {e}")

# ğŸ” ExploraciÃ³n inicial de los datos
print("\nğŸ”¹ Primeras filas del dataset:")
display(training_csv.head())

print("\nğŸ“Š InformaciÃ³n general:")
display(training_csv.info())

print("\nğŸ”º Valores nulos por columna:")
display(training_csv.isnull().sum())

# ğŸš€ Preprocesamiento de datos
# Rellenar valores nulos con la mediana
training_csv.fillna(training_csv.median(), inplace=True)

# Convertir a tipo numÃ©rico si es necesario
for col in training_csv.columns:
    if training_csv[col].dtype == "object":
        training_csv[col] = pd.to_numeric(training_csv[col], errors='coerce')

# Guardar los datos procesados
processed_path = "/content/drive/My Drive/PSF/training_v2_clean.csv"
training_csv.to_csv(processed_path, index=False)
print(f"âœ… Datos preprocesados y guardados en {processed_path}")
